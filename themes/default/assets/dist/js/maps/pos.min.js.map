{"version":3,"sources":["pos.js"],"names":["add_invoice_item","item","count","spositems","item_id","Settings","item_addition","id","row","qty","parseFloat","store","JSON","stringify","loadItems","get","total","an","product_tax","invoice_tax","product_discount","order_discount","total_discount","$","empty","time","Date","getTime","remote_printing","ob_info","pos_customer","text","hr","val","user","username","pos_curr_time","date","dateformat","timeformat","order_data","info","bill_data","o_items","b_items","style","pos_head","site_name","prepend","lang","order","bill","parse","each","this","product_id","item_type","type","item_tax_method","tax_method","combo_items","item_qty","item_aqty","quantity","item_ds","discount","item_code","code","item_name","name","replace","net_price","real_unit_price","item_comment","comment","item_was_ordered","ordered","ds","item_discount","formatDecimal","indexOf","pds","split","isNaN","pr_tax","parseInt","tax","pr_tax_val","inclusive","exclusive","row_no","newTr","tr_html","formatMoney","html","prependTo","oitb","scrollHeight","slimScroll","scrollTo","addClass","find","removeClass","comments","i","len","length","printLine","bprTr","oprTr","append","ts","order_tax","pts","g_total","grand_total","items","b_totals","rounding","round_total","roundNumber","total_payable","total_items","totals","bill_totals","merchant_copy","display_kb","display_keyboards","focus","chr","String","fromCharCode","jQuery","browser","mobile","keyboard","autoAccept","alwaysOpen","openOn","usePreview","layout","display","bksp","accept","default","meta1","meta2","customLayout","shift","restrictInput","preventPaste","b","calTax","nav_pointer","pp","p_page","attr","pro_limit","tcp","Popup","data","createWin","then","w","close","Promise","resolve","d","assets","mywindow","window","open","document","write","setTimeout","posScreen","wh","height","total_dh","buttons_dh","items_dh","list_table_dh","outerHeight","str","size","char_per_line","res","newd","read_card","ready","on","e","preventDefault","stopPropagation","hideseek","nodata","no_match_found","n","modal","closest","item_rid","unit_price","console","log","base_url","label","row_id","backdrop","price","is_valid_discount","bootbox","alert","unexpected_value","localStorage","setItem","is_numeric","new_qty","click","protect_delete","dialog","title","enter_pin_code","closeButton","message","buttons","danger","className","callback","success","delete","md5","pin_code","remove","location","href","wrong_pin","keypress","keyCode","trigger","confirm","r_u_sure","result","please_add_product","show","print_img","html2canvas","onrendered","canvas","img","toDataURL","post","spos_token","csrf_hash","form","serialize","printOrder","hide","printBill","apply_to","dval","focusToEnd","tval","ajax","url","dataType","cid","cat_id","category_id","products","per_page","autocomplete","source","minLength","autoFocus","delay","response","event","ui","content","_trigger","select","bind","inputmask","placeholder","no","generateCardNo","parent","children","gccode","gcname","gcvalue","gcprice","gcexpiry","file_required_fields","gc_data","Array","gcdata","hasOwnProperty","ref","type_reference_note","suspend","sid","appendTo","submit","gtotal","change","total_paying","total_paid","p_val","rounded_total","slideDown","slideUp","cn","async","balance","incorrect_gift_card","card_no","value","paying","$quick_cash","amt","contents","filter","nodeType","th","thousands_sep","$pi","join","note_count","spos_note","spos_customer","select2","hover","top","offset","menu","target","hasClass","hold_ref","status","msg","error","customer_request_failed","start","width","extend","keyaction","enter","base","$el","is","insertText","TrackData","p","SwipeParserObj","hasTrack1","CardType","ccn1","account","charAt","account_name","exp_month","exp_year","blur","removeData","clear","reload","focus_add_item","shortcut","add","propagate","add_customer","toggle_category_slider","cancel_sale","suspend_sale","print_order","print_bill","finalize_sale","today_sale","open_hold_bills","close_register","fn","v","ajaxSetup","cache","headers","cache-control"],"mappings":"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","file":"../pos.min.js","sourcesContent":["function add_invoice_item(item) {\n\n    if (count == 1) {\n        spositems = {};\n    }\n    if (item == null) {\n        return;\n    }\n\n    var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n    if (spositems[item_id]) {\n        spositems[item_id].row.qty = parseFloat(spositems[item_id].row.qty) + 1;\n    } else {\n        spositems[item_id] = item;\n    }\n\n    store('spositems', JSON.stringify(spositems));\n    loadItems();\n    return true;\n}\n\nfunction loadItems() {\n    if (count == 1) {\n        spositems = {};\n    }\n    if (get('spositems')) {\n        total = 0;\n        count = 1;\n        an = 1;\n        product_tax = 0;\n        invoice_tax = 0;\n        product_discount = 0;\n        order_discount = 0;\n        total_discount = 0;\n\n        $(\"#posTable tbody\").empty();\n        var time = ((new Date).getTime())/1000;\n        if (Settings.remote_printing != 1) {\n\n            var pos_customer = 'C: '+$('#select2-spos_customer-container').text()+ \"\\n\";\n            var hr = 'R: '+$('#hold_ref').val()+ \"\\n\";\n            var user = 'U: '+username+ \"\\n\";\n            var pos_curr_time = 'T: '+date(Settings.dateformat+' '+Settings.timeformat, time)+ \"\\n\";\n            var ob_info = pos_customer+hr+user+pos_curr_time+ \"\\n\";\n            order_data.info = ob_info;\n            bill_data.info = ob_info;\n            var o_items = '';\n            var b_items = '';\n\n        } else {\n            $(\"#order_span\").empty(); $(\"#bill_span\").empty();\n            var style = '<style>.bb td, .bb th { border-bottom: 1px solid #DDD; }</style>';\n            var pos_head = '<span style=\"text-align:center;\"><h3>'+Settings.site_name+'</h3>'\n            // var pos_customer = ''; // remove this line and uncomment below to display customer\n            var pos_customer = '<h5>C: '+$('#select2-spos_customer-container').text()+'</h5>';\n            var hr = '<h5>R: '+$('#hold_ref').val()+'</h5>';\n            var user = '<h5>U: '+username+'</h5>';\n            var pos_curr_time = '<h5>T: '+date(Settings.dateformat+' '+Settings.timeformat, time)+'</h5>';\n            $(\"#order_span\").prepend(style+pos_head+'<h4>'+lang.order+'</h4></span>'+pos_customer+hr+user+pos_curr_time);\n            $(\"#bill_span\").prepend(style+pos_head+'<h4>'+lang.bill+'</h4></span>'+pos_customer+hr+user+pos_curr_time);\n            $(\"#order-table\").empty(); $(\"#bill-table\").empty();\n        }\n        spositems = JSON.parse(get('spositems'));\n\n        $.each(spositems, function () {\n\n            var item = this;\n            var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n            spositems[item_id] = item;\n\n            var product_id = item.row.id, item_type = item.row.type, item_tax_method = parseFloat(item.row.tax_method), combo_items = item.combo_items, item_qty = item.row.qty, item_aqty = parseFloat(item.row.quantity), item_type = item.row.type, item_ds = item.row.discount, item_code = item.row.code, item_name = item.row.name.replace(/\"/g, \"&#034;\").replace(/'/g, \"&#039;\");\n            var unit_price = parseFloat(item.row.real_unit_price);\n            var net_price = unit_price;\n            var item_comment = item.row.comment;\n            var item_was_ordered = item.row.ordered ? item.row.ordered : 0;\n\n            var ds = item_ds ? item_ds : '0';\n            var item_discount = formatDecimal(ds);\n            if (ds.indexOf(\"%\") !== -1) {\n                var pds = ds.split(\"%\");\n                if (!isNaN(pds[0])) {\n                    item_discount = formatDecimal((parseFloat(((net_price) * parseFloat(pds[0])) / 100)), 4);\n                }\n            }\n            product_discount += formatDecimal((item_discount * item_qty), 4);\n            net_price = formatDecimal((net_price-item_discount), 4);\n\n            var pr_tax = parseInt(item.row.tax), pr_tax_val = 0;\n            if (pr_tax !== null && pr_tax != 0) {\n                if(item_tax_method == 0) {\n                    pr_tax_val = formatDecimal(((net_price * parseFloat(pr_tax)) / (100+parseFloat(pr_tax))), 4);\n                    net_price -= pr_tax_val;\n                    tax = lang.inclusive;\n                } else {\n                    pr_tax_val = formatDecimal(((net_price * parseFloat(pr_tax)) / 100), 4);\n                    tax = lang.exclusive;\n                }\n            }\n            product_tax += formatDecimal((pr_tax_val * item_qty), 4);\n\n            var row_no = (new Date).getTime();\n            var newTr = $('<tr id=\"' + row_no + '\" class=\"' + item_id + '\" data-item-id=\"' + item_id + '\" data-id=\"' + item.row.id + '\"></tr>');\n            tr_html = '<td><input name=\"product_id[]\" type=\"hidden\" class=\"rid\" value=\"' + product_id + '\"><input name=\"item_comment[]\" type=\"hidden\" class=\"ritem_comment\" value=\"' + item_comment + '\"><input name=\"product_code[]\" type=\"hidden\" value=\"' + item.row.code + '\"><input name=\"product_name[]\" type=\"hidden\" value=\"' + item.row.name + '\"><button type=\"button\" class=\"btn bg-purple btn-block btn-xs edit\" id=\"' + row_no + '\" data-item=\"' + item_id + '\"><span class=\"sname\" id=\"name_' + row_no + '\">' + item_name + ' (' + item_code + ')</span></button></td>';\n            // <input class=\"rprice\" name=\"net_price[]\" type=\"hidden\" id=\"price_' + row_no + '\" value=\"' + formatDecimal(item_price) + '\">\n            tr_html += '<td class=\"text-right\"><input class=\"realuprice\" name=\"real_unit_price[]\" type=\"hidden\" value=\"' + item.row.real_unit_price + '\"><input class=\"rdiscount\" name=\"product_discount[]\" type=\"hidden\" id=\"discount_' + row_no + '\" value=\"' + ds + '\"><span class=\"text-right sprice\" id=\"sprice_' + row_no + '\">' + formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) + '</span></td>';\n            tr_html += '<td><input name=\"item_was_ordered[]\" type=\"hidden\" class=\"riwo\" value=\"' + item_was_ordered + '\"><input class=\"form-control input-qty kb-pad text-center rquantity\" name=\"quantity[]\" type=\"text\" value=\"' + formatDecimal(item_qty) + '\" data-id=\"' + row_no + '\" data-item=\"' + item_id + '\" id=\"quantity_' + row_no + '\" onClick=\"this.select();\"></td>';\n            tr_html += '<td class=\"text-right\"><span class=\"text-right ssubtotal\" id=\"subtotal_' + row_no + '\">' + formatMoney(((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty))) + '</span></td>';\n            tr_html += '<td class=\"text-center\"><i class=\"fa fa-trash-o tip pointer posdel\" id=\"' + row_no + '\" title=\"Remove\"></i></td>';\n            newTr.html(tr_html);\n            newTr.prependTo(\"#posTable\");\n            total += formatDecimal(((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty)), 4);\n            count += parseFloat(item_qty);\n            an++;\n            // $('#list-table-div').scrollTop(0);\n            var oitb = $('#list-table-div')[0].scrollHeight;\n            $('#list-table-div').slimScroll({scrollTo: oitb});\n            if(item_type == 'standard' && item_qty > item_aqty) {\n                $('#' + row_no).addClass('danger');\n                $('#' + row_no).find('.edit').removeClass('bg-purple').addClass('btn-warning');\n            }\n            else if (item_type == 'combo') {\n                if(combo_items === false) {\n                    $('#' + row_no).addClass('danger');\n                } else {\n                    $.each(combo_items, function(){\n                        if(parseFloat(this.quantity) < (parseFloat(this.qty)*item_qty)) {\n                            $('#' + row_no).addClass('danger');\n                            $('#' + row_no).find('.edit').removeClass('bg-purple').addClass('btn-warning');\n                        }\n                    });\n                }\n            }\n\n            var comments = item_comment ? item_comment.split(/\\r?\\n/g) : [];\n            if (Settings.remote_printing != 1) {\n\n                b_items += \"#\"+(an-1)+\" \"+ item_name + \" (\" + item_code + \")\" + \"\\n\";\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    b_items += (comments[i].length > 0 ? \"   * \"+comments[i]+\"\\n\" : \"\");\n                }\n                b_items += printLine(item_qty + \" x \" + formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val))+\": \"+ formatMoney(((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty)))) + \"\\n\";\n                o_items += printLine(\"#\"+(an-1)+\" \"+ item_name + \" (\" + item_code + \"): [ \"+ (item_was_ordered != 0 ? 'xxxx' : item_qty)) + \" ]\\n\";\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    o_items += (comments[i].length > 0 ? \"   * \"+comments[i]+\"\\n\" : \"\");\n                }\n                o_items += \"\\n\";\n\n            } else {\n                var bprTr = '<tr class=\"row_' + item_id + '\" data-item-id=\"' + item_id + '\"><td colspan=\"2\">#'+(an-1)+' '+ (item_id == 0 ? item.row.name :item_name + ' (' + item_code + ')');\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    bprTr += (comments[i] ? '<br> <b>*</b> <small>'+comments[i]+'</small>' : '');\n                }\n                bprTr += '</td></tr>';\n                bprTr += '<tr class=\"bb row_' + item_id + '\" data-item-id=\"' + item_id + '\"><td>(' + item_qty + ' x ' + formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val))+ ')</td><td style=\"text-align:right;\">'+ formatMoney(((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty))) +'</td></tr>';\n                var oprTr = '<tr class=\"bb row_' + item_id + '\" data-item-id=\"' + item_id + '\"><td>#'+(an-1)+' ' + item_name + ' (' + item_code + ')';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    oprTr += (comments[i] ? '<br> <b>*</b> <small>'+comments[i]+'</small>' : '');\n                }\n                oprTr += '</td><td>[ '+(item_was_ordered != 0 ? 'xxxx' : item_qty)+' ]</td></tr>';\n                $(\"#order-table\").append(oprTr);\n                $(\"#bill-table\").append(bprTr);\n            }\n        });\n\n        var ds = get('spos_discount') ? get('spos_discount') :\n        ($('#discount_val').val() ? $('#discount_val').val() : '0');\n        order_discount = parseFloat(ds);\n        if(ds.indexOf(\"%\") !== -1) {\n            var pds = ds.split(\"%\");\n            order_discount = parseFloat((total*parseFloat(pds[0]))/100);\n        }\n\n        var ts = get('spos_tax') ? get('spos_tax') :\n        ($('#tax_val').val() ? $('#tax_val').val() : '0');\n        order_tax = parseFloat(ts);\n        if(ts.indexOf(\"%\") !== -1) {\n            var pts = ts.split(\"%\");\n            order_tax = ((total-order_discount)*parseFloat(pts[0]))/100;\n        }\n\n        var g_total = total - parseFloat(order_discount) + parseFloat(order_tax);\n        grand_total = formatMoney(g_total);\n        $(\"#ds_con\").text('('+formatMoney(product_discount)+') '+formatMoney(order_discount));\n        $(\"#ts_con\").text(formatMoney(order_tax));\n        $(\"#total-payable\").text(grand_total);\n        $(\"#total\").text(formatMoney(total));\n        $(\"#count\").text((an-1)+' ('+formatMoney(count-1)+')');\n\n        if (Settings.remote_printing != 1) {\n\n            order_data.items = o_items;\n            bill_data.items = b_items;\n            var b_totals = '';\n            b_totals += printLine(lang.total+': '+ formatMoney(total)) +\"\\n\";\n            if(order_discount > 0 || product_discount > 0) {\n                b_totals += printLine(lang.discount+': '+ formatMoney(order_discount+product_discount)) +\"\\n\";\n            }\n            if (order_tax != 0) {\n                b_totals += printLine(lang.order_tax+': '+ formatMoney(order_tax)) +\"\\n\";\n            }\n            b_totals += printLine(lang.grand_total+': '+ formatMoney(g_total)) +\"\\n\";\n            if(Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal((round_total - g_total), 4);\n                b_totals += printLine(lang.rounding+': '+ formatMoney(rounding)) +\"\\n\";\n                b_totals += printLine(lang.total_payable+': '+ formatMoney(round_total)) +\"\\n\";\n            }\n            b_totals += \"\\n\"+ lang.total_items+': '+ (an - 1) + ' (' + (parseFloat(count) - 1) + ')' +\"\\n\";\n            bill_data.totals = b_totals;\n\n        } else {\n            var bill_totals = '';\n            bill_totals += '<tr class=\"bb\"><td>'+lang.total_items+'</td><td style=\"text-align:right;\">'+(an - 1) + ' (' + (parseFloat(count) - 1) + ')</td></tr>';\n            bill_totals += '<tr class=\"bb\"><td>'+lang.total+'</td><td style=\"text-align:right;\">'+formatMoney(total)+'</td></tr>';\n            if(order_discount > 0 || product_discount > 0) {\n                bill_totals += '<tr class=\"bb\"><td>'+lang.discount+'</td><td style=\"text-align:right;\">'+formatMoney(order_discount+product_discount)+'</td></tr>';\n            }\n            if (order_tax != 0) {\n                bill_totals += '<tr class=\"bb\"><td>'+lang.order_tax+'</td><td style=\"text-align:right;\">'+formatMoney(order_tax)+'</td></tr>';\n            }\n            bill_totals += '<tr class=\"bb\"><td>'+lang.grand_total+'</td><td style=\"text-align:right;\">'+formatMoney(g_total)+'</td></tr>';\n            if(Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal((round_total - g_total), 4);\n                bill_totals += '<tr class=\"bb\"><td>'+lang.rounding+'</td><td style=\"text-align:right;\">'+formatMoney(rounding)+'</td></tr>';\n                bill_totals += '<tr class=\"bb\"><td>'+lang.total_payable+'</td><td style=\"text-align:right;\">'+formatMoney(round_total)+'</td></tr>';\n            }\n            bill_totals += '<tr class=\"bb\"><td colspan=\"2\" style=\"text-align:center;\">'+lang.merchant_copy+'</td></tr>';\n            $('#bill-total-table').empty();\n            $('#bill-total-table').append(bill_totals);\n        }\n\n        if (Settings.display_kb == 1) { display_keyboards(); }\n        $('#add_item').focus();\n    }\n}\n\nfunction chr(i) {\n    return String.fromCharCode(i);\n}\n\n$(document).ready(function () {\n\n    $(document).on('click', '.no-results, #filter-suspended-sales', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    $('#susModal').on('shown.bs.modal', function (e) {\n        $('#reference_note').focus();\n    })\n\n    $('#filter-categories').hideseek({\n        nodata: lang.no_match_found\n    });\n\n    $(document).on('click', '.suspended_sales .dropdown-menu .header', function (e) {\n        e.stopPropagation();\n    });\n\n    $('#filter-suspended-sales').hideseek({\n        nodata: lang.no_match_found\n    });\n\n    $('#suspended_sales').on('shown.bs.dropdown', function () {\n        $('#filter-suspended-sales').focus();\n    });\n\n    $(document).on('click', '#update-note', function(){\n        var n = $('#snote').val();\n        store('spos_note', n);\n        $('#note').val(n);\n        $('#noteModal').modal('hide');\n    });\n    /* =============================\n    Edit Item Modal\n    ============================= */\n\n    $(\"#posTable\").on(\"click\", '.edit', function() {\n        var row = $(this).closest('tr');\n        var id = row.attr('id');\n        var item_id = row.attr('data-item-id');\n        var item_rid = row.attr('data-id');\n        var item = spositems[item_id];\n        //var unit_price = parseFloat(item.row.real_unit_price);\n        var unit_price = formatDecimal(row.find('.realuprice').val());\n        var net_price = unit_price;\n        var ds = item.row.discount ? item.row.discount : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf(\"%\") !== -1) {\n            var pds = ds.split(\"%\");\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((net_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax), pr_tax_val = 0, tax = '';\n        if (pr_tax !== null && pr_tax != 0) {\n            if(parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100+parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n        console.log(item_rid, item_id, id);\n        $('#proModalLabel').html('<a href=\"'+base_url+'/products/view/'+item_rid+'\" data-toggle=\"ajax\">'+item.label+'</a>');\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n        $('#pro_tax_method').text('('+tax+')');\n        $('#row_id').val(row_id);\n        $('#item_id').val(item_id);\n        $('#nPrice').val(unit_price);\n        $('#nQuantity').val(item.row.qty);\n        $('#nDiscount').val(ds);\n        $('#nComment').val(item.row.comment);\n        $('#proModal').modal({backdrop:'static'});\n    });\n\n    $(document).on('change', '#nPrice, #nDiscount', function () {\n        var item_id = $('#item_id').val();\n        var unit_price = parseFloat($('#nPrice').val());\n        var net_price = unit_price;\n        var item = spositems[item_id];\n        var ds = $('#nDiscount').val() ? $('#nDiscount').val() : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf(\"%\") !== -1) {\n            var pds = ds.split(\"%\");\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((unit_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax), pr_tax_val = 0;\n        if (pr_tax !== null && pr_tax != 0) {\n            if(parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100+parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n    });\n\n    /* =============================\n    Edit Item Method\n    ============================= */\n     $(document).on('click', '#editItem', function () {\n        var item_id = $('#item_id').val();\n        var price = parseFloat($('#nPrice').val());\n        if(!is_valid_discount($('#nDiscount').val())) {\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        spositems[item_id].row.qty = parseFloat($('#nQuantity').val()),\n        spositems[item_id].row.real_unit_price = price,\n        spositems[item_id].row.comment = $('#nComment').val(),\n        spositems[item_id].row.discount = $('#nDiscount').val() ? $('#nDiscount').val() : '0',\n        localStorage.setItem('spositems', JSON.stringify(spositems));\n        $('#proModal').modal('hide');\n\n        loadItems();\n        return;\n    });\n\n    /* =============================\n    Row quantity change\n    ============================= */\n    $(document).on(\"change\", '.rquantity', function () {\n        var row = $(this).closest('tr');\n        if (!is_numeric($(this).val()) || $(this).val() == 0) {\n            loadItems();\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        var new_qty = parseFloat($(this).val()),\n        item_id = row.attr('data-item-id');\n        spositems[item_id].row.qty = new_qty;\n        localStorage.setItem('spositems', JSON.stringify(spositems));\n        loadItems();\n    });\n\n    $('#reset').click(function (e) {\n        if (count <= 1) {\n            return false;\n        }\n        if(protect_delete == 1) {\n            var boxd = bootbox.dialog({\n                title: lang.enter_pin_code,\n                closeButton: true,\n                message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                buttons: {\n                    danger: {\n                      label: lang.close,\n                      className: \"btn-default pull-left\",\n                      callback: function() { }\n                  },\n                  success: {\n                    label: \"<i class='fa fa-tick'></i> \"+lang.delete,\n                    className: \"btn-warning verify_pin\",\n                    callback: function () {\n                        var pos_pin = md5($('#pos_pin').val());\n                        if (pos_pin == Settings.pin_code) {\n                            if (get('spositems')) { remove('spositems'); }\n                            if (get('spos_tax')) { remove('spos_tax'); }\n                            if (get('spos_discount')) { remove('spos_discount'); }\n                            if (get('spos_customer')) { remove('spos_customer'); }\n                            window.location.href = base_url+\"pos\";\n                        } else {\n                            bootbox.alert(lang.wrong_pin);\n                        }\n                    }\n                }\n            }\n        });\n            boxd.on(\"shown.bs.modal\", function() {\n                if (Settings.display_kb == 1) { display_keyboards(); }\n                $( \"#pos_pin\" ).focus().keypress(function(e) {\n                    if (e.keyCode == 13) {\n                        e.preventDefault();\n                        $('.verify_pin').trigger('click');\n                        return false;\n                    }\n                });\n            });\n        } else {\n            bootbox.confirm(lang.r_u_sure, function (result) {\n                if (result) {\n                    if (get('spositems')) { remove('spositems'); }\n                    if (get('spos_tax')) { remove('spos_tax'); }\n                    if (get('spos_discount')) { remove('spos_discount'); }\n                    if (get('spos_customer')) { remove('spos_customer'); }\n                    window.location.href = base_url+\"pos\";\n                }\n            });\n        }\n    });\n\n    $('#print_order').click(function (e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#order-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preo').html('<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;\">' + order_data.info + order_data.items + '</pre>');\n                    html2canvas($('#order-data'), {\n                        onrendered: function(canvas) {\n                            // Canvas2Image.saveAsPNG(canvas);\n                            var img = canvas.toDataURL().split(',')[1];\n                            $.post(base_url+'pos/receipt_img', {img: img, spos_token: csrf_hash});\n                        }\n                    });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url+'pos/p/order', form);\n                }\n            } else {\n                printOrder(order_data);\n            }\n        }\n        setTimeout(function() { $('#order-data').hide(); }, 500);\n        return false;\n    });\n\n    $('#print_bill').click(function (e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#bill-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preb').html('<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;\">' + bill_data.info + bill_data.items + \"\\n\" + bill_data.totals + '</pre>');\n                    html2canvas($('#bill-data'), {\n                        onrendered: function(canvas) {\n                            var img = canvas.toDataURL().split(',')[1];\n                            $.post(base_url+'pos/receipt_img', {img: img, spos_token: csrf_hash});\n                        }\n                    });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url+'pos/p/bill', form);\n                }\n            } else {\n                printBill(bill_data);\n            }\n        }\n        setTimeout(function() { $('#bill-data').hide(); }, 500);\n        return false;\n    });\n\n    $(\"#updateDiscount\").click(function() {\n        var ds = $('#get_ds').val() ? $('#get_ds').val() : '0';\n        var apply_to = $('input[name=apply_to]:checked').val();\n        if (ds.length != 0) {\n        if (apply_to == 'order') {\n            $('#discount_val').val(ds);\n            store('spos_discount', ds);\n            if(ds.indexOf(\"%\") !== -1) {\n                var pds = ds.split(\"%\");\n\n                    order_discount = (total*parseFloat(pds[0]))/100;\n                    order_tax = calTax();\n                    var g_total = total + order_tax - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ds_con\").text('('+formatMoney(product_discount)+') '+formatMoney(order_discount));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n\n            } else {\n\n                    order_discount = ds;\n                    order_tax = calTax();\n                    var g_total = (total + order_tax) - parseFloat(order_discount);\n                    grand_total = parseFloat(g_total);\n                    $(\"#ds_con\").text('('+formatMoney(product_discount)+') '+formatMoney(order_discount));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n            }\n        } else if (apply_to == 'products') {\n            var items = {};\n            spositems = JSON.parse(get('spositems'));\n            $.each(spositems, function () {\n                this.row.discount = ds;\n            });\n            store('spositems', JSON.stringify(spositems));\n        }\n        loadItems();\n        $('#dsModal').modal('hide');\n    }\n    });\n\n    $(\"#add_discount\").click(function() {\n        var dval = $('#discount_val').val();\n        $('#get_ds').val(dval);\n        $('#dsModal').modal({backdrop:'static'});\n        return false;\n    });\n    $('#dsModal').on('shown.bs.modal', function () {\n        $('#get_ds').focusToEnd();\n    });\n\n    $(\"#updateTax\").click(function() {\n        var ts = $('#get_ts').val();\n        if (ts.length != 0) {\n            $('#tax_val').val(ts);\n            store('spos_tax', ts);\n            if(ts.indexOf(\"%\") !== -1) {\n                var pts = ts.split(\"%\");\n                if(! isNaN(pts[0])){\n                    order_tax = ((total-order_discount)*parseFloat(pts[0]))/100;\n                    var g_total = (total + order_tax) - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text(formatMoney(order_tax));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0'); $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text('0');\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                }\n            } else {\n                if(! isNaN(ts) && ts != 0){\n                    order_tax = ts;\n                    var g_total = (total + parseFloat(ts)) - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text(formatMoney(order_tax));\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0'); $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $(\"#ts_con\").text('0');\n                    $(\"#total-payable\").text(formatMoney(grand_total));\n                }\n            }\n            $('#tsModal').modal('hide');\n        }\n    });\n\n    $(\"#add_tax\").click(function() {\n        var tval = $('#tax_val').val();\n        $('#get_ts').val(tval);\n        $('#tsModal').modal({backdrop:'static'});\n        return false;\n    });\n    $('#tsModal').on('shown.bs.modal', function () {\n        $('#get_ts').focusToEnd();\n    });\n    $('#noteModal').on('shown.bs.modal', function () {\n        $('#snote').focusToEnd();\n    });\n\n    $(document).on('click', '.product', function (e) {\n        code = $(this).val();\n        $.ajax({\n            type: \"get\",\n            url: base_url+'pos/get_product/'+code,\n            dataType: \"json\",\n            success: function (data) {\n                if (data !== null) {\n                    add_invoice_item(data);\n                } else {\n                    bootbox.alert(lang.no_match_found);\n                }\n            }\n        });\n    });\n\n    $(document).on('click', '.category', function () {\n        var cid = $(this).attr('id');\n        if (cat_id != cid) {\n            cat_id = cid;\n            $.ajax({\n                type: \"get\",\n                url: base_url+'pos/ajaxproducts',\n                data: {category_id: cat_id, tcp: 1},\n                dataType: \"json\",\n                success: function (data) {\n                    p_page = 'n';\n                    // $('#categories-list').addClass('control-sidebar-open');\n                    //ocat_id = cat_id;\n                    tcp = data.tcp;\n                    $('.items').html(data.products);\n                    $('.category').removeClass('active');\n                    $('#' + cat_id).addClass('active');\n                    nav_pointer();\n                }\n            });\n        }\n        return false;\n    });\n    $('#category-' + cat_id).addClass('active');\n\n    $('#next').click(function () {\n        if (p_page == 'n') { p_page = 0; }\n        p_page += pro_limit;\n        if (tcp >= pro_limit && p_page < tcp) {\n            $.ajax({\n                type: \"get\",\n                url: base_url+'pos/ajaxproducts',\n                data: {category_id: cat_id, per_page: p_page},\n                dataType: \"html\",\n                success: function (data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                }\n            });\n        } else {\n            p_page -= pro_limit;\n        }\n    });\n\n    $('#previous').click(function () {\n        if (p_page == 'n') { p_page = 0; }\n        if (p_page != 0) {\n            p_page -= pro_limit;\n            if (p_page == 0) { p_page = 'n'; }\n            $.ajax({\n                type: \"get\",\n                url: base_url+'pos/ajaxproducts',\n                data: {category_id: cat_id, per_page: p_page},\n                dataType: \"html\",\n                success: function (data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                }\n            });\n        }\n    });\n\n    $(\"#add_item\").autocomplete({\n        source: base_url+'pos/suggestions',\n        minLength: 1,\n        autoFocus: false,\n        delay: 200,\n        response: function (event, ui) {\n            if ($(this).val().length >= 16 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function () {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            }\n            else if (ui.content.length == 1 && ui.content[0].id != 0) {\n                ui.item = ui.content[0];\n                $(this).data('ui-autocomplete')._trigger('select', 'autocompleteselect', ui);\n                $(this).autocomplete('close');\n            }\n            else if (ui.content.length == 1 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function () {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            }\n        },\n        select: function (event, ui) {\n            event.preventDefault();\n            if (ui.item.id !== 0) {\n                var row = add_invoice_item(ui.item);\n                if (row)\n                    $(this).val('');\n            } else {\n                bootbox.alert(lang.no_match_found);\n            }\n        }\n    });\n\n    $('#add_item').bind('keypress', function (e) {\n        if (e.keyCode == 13) {\n            e.preventDefault();\n            $(this).autocomplete(\"search\");\n        }\n    });\n\n    $('#add_item').focus();\n    $('#gccard_no').inputmask(\"9999 9999 9999 9999\");\n    $('#gift_card_no').inputmask(\"9999 9999 9999 9999\");\n    $(\"#gcexpiry\").inputmask(\"yyyy-mm-dd\", {\"placeholder\": \"yyyy-mm-dd\"});\n    $('#genNo').click(function () {\n        var no = generateCardNo();\n        $(this).parent().parent('.input-group').children('input').val(no);\n        return false;\n    });\n\n    $(document).on('click', '#sellGiftCard', function (e) {\n        if (count == 1) {\n            spositems = {};\n        }\n        $('#gcModal').modal({backdrop:'static'});\n     });\n\n    $(document).on('click', '#addGiftCard', function (e) {\n        var mid = 0,\n        gccode = $('#gccard_no').val(),\n        gcname = $('#gcname').val(),\n        gcvalue = $('#gcvalue').val(),\n        gcprice = parseFloat($('#gcprice').val());\n        gcexpiry = $('#gcexpiry').val();\n        if(gccode == '' || gcvalue == '' || gcprice == '' || gcvalue == 0 || gcprice == 0) {\n            $('#gcerror').text(lang.file_required_fields);\n            $('.gcerror-con').show();\n            return false;\n        }\n        var gc_data = new Array();\n        gc_data[0] = gccode;\n        gc_data[1] = gcvalue;\n        gc_data[2] = gcexpiry;\n\n        $.ajax({\n            type: 'get',\n            url: base_url+'gift_cards/sell_gift_card',\n            dataType: \"json\",\n            data: { gcdata: gc_data },\n            success: function (data) {\n                if(data.result === 'success') {\n                    spositems[mid] = {\"id\": mid, \"item_id\": mid, \"label\": gcname + ' (' + gccode + ')', \"row\": {\"id\": mid, \"code\": gccode, \"name\": gcname, \"quantity\": 1, \"price\": gcprice, \"real_unit_price\": gcprice, \"tax\": 0, \"qty\": 1, \"type\": \"manual\", \"discount\": \"0\", \"comment\": \"\"}};\n                    store('spositems', JSON.stringify(spositems));\n                    loadItems();\n                    $('#gcModal').modal('hide');\n                    $('#gccard_no').val('');\n                    $('#gcvalue').val('');\n                    $('#gcprice').val('');\n                } else {\n                    $('#gcerror').text(data.message);\n                    $('.gcerror-con').show();\n                }\n            }\n        });\n    });\n\n    // $('#opModal').bind().on('click', 'a', function(){\n    //     var pg = $.url($(this).attr(\"href\")).param(\"per_page\");\n    //     $.get( base_url+'pos/ob_page&per_page='+pg, function( data ) {\n    //         $( \".html_con\" ).html( data.pd );\n    //         $( \".page_con\" ).html( data.page );\n    //     }, \"json\");\n\n    //     return false;\n    // });\n\n\n        var pwacc = false;\n        $(document).on('click', '.posdel', function () {\n            var row = $(this).closest('tr');\n            var item_id = row.attr('data-item-id');\n            if(protect_delete == 1) {\n                var boxd = bootbox.dialog({\n                    title: lang.enter_pin_code,\n                    closeButton: true,\n                    message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                    buttons: {\n                        danger: {\n                          label: lang.close,\n                          className: \"btn-default pull-left\",\n                          callback: function() { }\n                        },\n                        success: {\n                            label: \"<i class='fa fa-tick'></i> \"+lang.delete,\n                            className: \"btn-warning verify_pin\",\n                            callback: function () {\n                                var pos_pin = md5($('#pos_pin').val());\n                                if(pos_pin == Settings.pin_code) {\n                                    delete spositems[item_id];\n                                    row.remove();\n                                    if(spositems.hasOwnProperty(item_id)) { } else {\n                                        localStorage.setItem('spositems', JSON.stringify(spositems));\n                                        loadItems();\n                                    }\n                                } else {\n                                    bootbox.alert(lang.wrong_pin);\n                                }\n                            }\n                        }\n                    }\n                });\n            boxd.on(\"shown.bs.modal\", function() {\n                if (Settings.display_kb == 1) { display_keyboards(); }\n                $( \"#pos_pin\" ).focus().keypress(function(e) {\n                    if (e.keyCode == 13) {\n                        e.preventDefault();\n                        $('.verify_pin').trigger('click');\n                        return false;\n                    }\n                });\n            });\n        } else {\n            delete spositems[item_id];\n            row.remove();\n            if(spositems.hasOwnProperty(item_id)) { } else {\n                localStorage.setItem('spositems', JSON.stringify(spositems));\n                loadItems();\n            }\n        }\n        return false;\n    });\n\n    $('#suspend').click(function () {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n            $('#susModal').modal({backdrop:'static'});\n        }\n    });\n\n    $('#suspend_sale').click(function () {\n        ref = $('#reference_note').val();\n        if (!ref || ref == '') {\n            bootbox.alert(lang.type_reference_note);\n            return false;\n        } else {\n            suspend = $('<span></span>');\n            if (sid !== 0) {\n                suspend.html('<input type=\"hidden\" name=\"delete_id\" value=\"'+sid+'\" /><input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' + ref + '\" />');\n            } else {\n                suspend.html('<input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' + ref + '\" />');\n            }\n            suspend.appendTo(\"#hidesuspend\");\n            $('#pos-sale-form').submit();\n        }\n    });\n\n    $('#payment').click(function () {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n\n            if (sid) {\n            suspend = $('<span></span>');\n            suspend.html('<input type=\"hidden\" name=\"delete_id\" value=\"'+sid+'\" />');\n            suspend.appendTo(\"#hidesuspend\");\n            }\n\n            gtotal = formatDecimal(total - order_discount + order_tax);\n            if(Settings.rounding != 0) {\n                round_total = roundNumber(gtotal, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - gtotal);\n                $('#twt').text(formatMoney(round_total) + ' (' + formatMoney(rounding) + ')');\n                $('#quick-payable').text(round_total);\n            } else {\n                $('#twt').text(formatMoney(gtotal));\n                $('#quick-payable').text(gtotal);\n            }\n            $('#item_count').text((an-1)+' ('+(count-1)+')');\n            $(\"#order_quantity\").val(count-1);\n            $(\"#order_items\").val(an-1);\n            $('#balance').text('0.00');\n            $('#payModal').modal({backdrop:'static'});\n\n        }\n    });\n    $('#payModal').on('shown.bs.modal', function (e) {\n        $('#amount').focus().val(0);\n        $('#quick-payable').click();\n    });\n    $('#payModal').on('hidden.bs.modal', function (e) {\n        $('#amount').val('').change();\n    });\n\n    $('#amount').change(function(e) {\n        var total_paying = $(\".amount\").val();\n        $('#total_paying').text(formatMoney(total_paying));\n        if(Settings.rounding != 0) {\n            $('#balance').text(formatMoney(total_paying - round_total));\n            $('#balance_val').val(formatDecimal(total_paying - round_total));\n            total_paid = total_paying;\n            grand_total = round_total;\n        } else {\n            $('#balance').text(formatMoney(total_paying - gtotal));\n            $('#balance_val').val(formatDecimal(total_paying - gtotal));\n            total_paid = total_paying;\n            grand_total = gtotal;\n        }\n    });\n\n    $('#add-customer').click(function () {\n        $('#customerModal').modal({backdrop:'static'});\n    });\n\n    $('#payModal').on('change', '#paid_by', function () {\n        $('#clear-cash-notes').click();\n        $('#amount').val(grand_total);\n        var p_val = $(this).val();\n        $('#paid_by_val').val(p_val);\n        var gtotal = formatDecimal(total - order_discount + order_tax);\n        if(Settings.rounding != 0) {\n            var rounded_total = formatDecimal(roundNumber(gtotal, parseInt(Settings.rounding)));\n        } else {\n            var rounded_total = formatDecimal(gtotal);\n        }\n        $('#rpaidby').val(p_val);\n        if (p_val == 'gift_card') {\n            $('.gc').slideDown();\n            $('.ngc').slideUp('fast');\n            setTimeout(function(){ $('#gift_card_no').focus(); }, 10);\n            $('#amount').attr('readonly', true);\n        } else {\n            $('.ngc').slideDown();\n            $('.gc').slideUp('fast');\n            $('#gc_details').html('');\n            $('#amount').attr('readonly', false);\n        }\n        if (p_val == 'cash' || p_val == 'other') {\n            $('.pcash').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcc').slideUp('fast');\n            setTimeout(function(){ $('#amount').focus(); }, 10);\n        } else if (p_val == 'CC' || p_val == 'stripe') {\n            $('.pcc').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function(){ $('#swipe').val('').focus(); }, 10);\n        } else if (p_val == 'cheque') {\n            $('.pcheque').slideDown();\n            $('.pcc').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function(){ $('#cheque_no').focus(); }, 10);\n        } else {\n            $('.pcheque').hide();\n            $('.pcc').hide();\n            $('.pcash').hide();\n        }\n    });\n\n    $(document).on('change', '.gift_card_no', function () {\n        var cn = $(this).val() ? $(this).val() : '';\n        if (cn != '') {\n            $.ajax({\n                type: \"get\", async: false,\n                url: base_url + \"pos/validate_gift_card/\" + cn,\n                dataType: \"json\",\n                success: function (data) {\n                    if (data === false || data.balance < 0) {\n                        $('#gift_card_no').parent('.form-group').addClass('has-error');\n                        bootbox.alert(lang.incorrect_gift_card);\n                    } else {\n                        $('#gc_details').html(lang.card_no+': ' + data.card_no + '<br>'+lang.value+': ' + data.value + ' - '+lang.balance+': ' + data.balance);\n                        $('#gift_card_no').parent('.form-group').removeClass('has-error');\n                        var paying = (gtotal > data.balance) ? data.balance : gtotal;\n                        $('#amount_val').val(paying);\n                        $('#amount').val(paying);\n                    }\n                }\n            });\n        }\n        return false;\n    });\n\n    $(document).on('click', '#quick-payable', function () {\n        $('#clear-cash-notes').click();\n        $(this).append('<span class=\"badge\">1</span>');\n        $('#amount').val(grand_total);\n    });\n\n    $(document).on('click', '.quick-cash', function () {\n        if ($('#quick-payable').find('span.badge').length) {\n            $('#clear-cash-notes').click();\n        }\n        var $quick_cash = $(this);\n        var amt = $quick_cash.contents().filter(function () {\n            return this.nodeType == 3;\n        }).text();\n        var th = Settings.thousands_sep == 0 ? '' : Settings.thousands_sep;\n        var $pi = $('#amount');\n        amt = formatDecimal(amt.split(th).join(\"\")) * 1 + $pi.val() * 1;\n        $pi.val(formatDecimal(amt)).change().focus();\n        var note_count = $quick_cash.find('span');\n        if (note_count.length == 0) {\n            $quick_cash.append('<span class=\"badge\">1</span>');\n        } else {\n            note_count.text(parseInt(note_count.text()) + 1);\n        }\n    });\n\n    $(document).on('click', '#clear-cash-notes', function () {\n        $('.quick-cash').find('.badge').remove();\n        $('#amount').val('').change().focus();\n    });\n\n    $('#payModal').on('change', '#amount, #paid_by', function (e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('blur', '#amount', function (e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('select2-close', '#paid_by', function (e) {\n        $('#paid_by_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_no', function (e) {\n        $('#cc_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_holder', function (e) {\n        $('#cc_holder_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#gift_card_no', function (e) {\n        $('#paying_gift_card_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_month', function (e) {\n        $('#cc_month_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_year', function (e) {\n        $('#cc_year_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_type', function (e) {\n        $('#cc_type_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_cvv2', function (e) {\n        $('#cc_cvv2_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#cheque_no', function (e) {\n        $('#cheque_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#payment_note', function (e) {\n        $('#payment_note_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#note', function (e) {\n        var n = $(this).val();\n        store('spos_note', n);\n        $('#spos_note').val(n);\n    });\n    if(spos_note = get('spos_note')) {\n        $('#note').val(spos_note);\n        $('#snote').val(spos_note);\n    }\n    $('#spos_customer').change( function (e) {\n        store('spos_customer', $(this).val());\n    });\n    if(spos_customer = get('spos_customer')) {\n        $('#spos_customer').select2('val', spos_customer);\n    }\n\n    $('.treeview').hover(function(e) {\n        var wh = $(document).height();\n        var top = $(this).offset().top;\n        var menu = $(this).find('.treeview-menu');\n        var menuh = menu.height() + 44;\n        if ((wh-top) < menuh) {\n            $(this).find('a').children('span').addClass('popup')\n            menu.addClass('popup');\n        } else {\n            $(this).find('a').children('span').removeClass('popup')\n            menu.removeClass('popup');\n        }\n    });\n\n    $('body').click(function(e) {\n        if (!$(e.target).hasClass('sidebar-icon') && !$(e.target).hasClass('sb') && $('#categories-list').hasClass('control-sidebar-open')) {\n            $('#categories-list').removeClass('control-sidebar-open');\n        }\n    });\n\n    $('#submit-sale').click(function() {\n        $('#total_items').val(an - 1);\n        $('#total_quantity').val(count - 1);\n        // console.log($('#amount_val').val());\n        $('#submit').click();\n    });\n\n    var hold_ref = $('#hold_ref').val();\n    $('#hold_ref').change(function () {\n        hold_ref = $(this).val();\n        $('#reference_note').val(hold_ref);\n    });\n    $('#reference_note').change(function () {\n        hold_ref = $(this).val();\n        $('#hold_ref').val(hold_ref);\n    });\n\n    $('#suspend_sale').click(function() {\n        if($('#reference_note').val()) {\n            $('#hold_ref').val($('#reference_note').val());\n            $('#total_items').val(an - 1);\n            $('#total_quantity').val(count - 1);\n            $('#submit').click();\n        }\n        return false;\n    });\n\n    $(\"#customer-form\").on(\"submit\", function(e) {\n        e.preventDefault();\n        $.ajax({\n            type: \"post\",\n            url: base_url+'customers/add',\n            data: $( this ).serialize(),\n            dataType: \"json\",\n            success: function(res) {\n                if(res.status == 'success') {\n                    $('#spos_customer').append($(\"<option></option>\").attr(\"value\",res.id).text(res.val));\n                    $('#spos_customer').select2('val', res.id);\n                    $('#customerModal').modal('hide');\n                } else {\n                    $('#c-alert').html(res.msg);\n                    $('#c-alert').show();\n                }\n            },\n            error: function(){\n                bootbox.alert(lang.customer_request_failed);\n                return false;\n            }\n        });\n        return false;\n    });\n\n    $('#customerModal').on('hidden.bs.modal', function (e) {\n        $('#c-alert').hide();\n        $('#cname').val('');\n        $('#cemail').val('');\n        $('#cphone').val('');\n        $('#cf1').val('');\n        $('#cf2').val('');\n    });\n\n});\n\nfunction display_keyboards() {\n    if( ! jQuery.browser.mobile) {\n        $('.kb-text').keyboard({\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'focus',\n            usePreview: false,\n            // layout: 'qwerty',\n            layout: 'custom',\n            display: {\n                'bksp': \"\\u2190\",\n                'accept': 'return',\n                'default': 'ABC',\n                'meta1': '123',\n                'meta2': '#+='\n            },\n            customLayout: {\n                'default': [\n                    'q w e r t y u i o p {bksp}',\n                    'a s d f g h j k l {enter}',\n                    '{s} z x c v b n m , . {s}',\n                    '{meta1} {space} {cancel} {accept}'\n                ],\n                'shift': [\n                    'Q W E R T Y U I O P {bksp}',\n                    'A S D F G H J K L {enter}',\n                    '{s} Z X C V B N M / ? {s}',\n                    '{meta1} {space} {meta1} {accept}'\n                ],\n                'meta1': [\n                    '1 2 3 4 5 6 7 8 9 0 {bksp}',\n                    '- / : ; ( ) \\u20ac & @ {enter}',\n                    '{meta2} . , ? ! \\' \" {meta2}',\n                    '{default} {space} {default} {accept}'\n                ],\n                'meta2': [\n                    '[ ] { } # % ^ * + = {bksp}',\n                    '_ \\\\ | &lt; &gt; $ \\u00a3 \\u00a5 {enter}',\n                    '{meta1} ~ . , ? ! \\' \" {meta1}',\n                    '{default} {space} {default} {accept}'\n                ]}\n        });\n\n        $('.kb-pad').keyboard({\n            restrictInput: true,\n            preventPaste: true,\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'click',\n            usePreview: false,\n            layout: 'costom',\n            display: {\n                'b': '\\u2190:Backspace'\n            },\n            customLayout: {\n                'default': [\n                    '1 2 3 {b}',\n                    '4 5 6 . {clear}',\n                    '7 8 9 0 %',\n                    '{accept} {cancel}'\n                ]\n            }\n        });\n    }\n}\n\nfunction calTax() {\n    var ts = get('spos_tax') ? get('spos_tax') : $('#tax_val').val();\n    if(ts.indexOf(\"%\") !== -1) {\n        var pts = ts.split(\"%\");\n        order_tax = ((total-order_discount)*parseFloat(pts[0]))/100;\n        $(\"#ts_con\").text(formatMoney(order_tax));\n    } else {\n        order_tax = parseFloat(ts);\n        $(\"#ts_con\").text(formatMoney(order_tax));\n    }\n    return order_tax;\n}\n\nfunction nav_pointer() {\n    var pp = p_page == 'n' ? 0 : p_page;\n    (pp == 0) ? $('#previous').attr('disabled', true) : $('#previous').attr('disabled', false);\n    ((pp+pro_limit) > tcp) ? $('#next').attr('disabled', true) : $('#next').attr('disabled', false);\n}\n\nfunction Popup(data) {\n    createWin(data).then(function (w) {\n        w.close();\n    });\n}\nfunction createWin(data) {\n    return new Promise(function(resolve) {\n        var d = '<!DOCTYPE html><html><head><title>Print</title><link rel=\"stylesheet\" href=\"'+assets+'bootstrap/css/bootstrap.min.css\" type=\"text/css\" /></head><body>'+data+'<script type=\"text/javascript\">window.print();</script></body></html>';\n        var mywindow = window.open(d, 'spos_print', 'height=500,width=300');\n        mywindow.document.write(d);\n        setTimeout(function() { resolve(mywindow); }, 20);\n    });\n}\n\n$(document).ready(function($) {\n    window.setTimeout(function() {\n        $('.alerts').slideUp();\n    }, 15000);\n    $('.alerts').on('click',function(e) {\n        $(this).slideUp();\n    });\n    $('#list-table-div').slimScroll({start: 'bottom'});\n    $('#category-sidebar-menu').slimScroll({width: '100%'});\n    $('.items').slimScroll({});\n});\n\nfunction posScreen() {\n    var wh = $(window).height(),\n    total_dh = $('#totaldiv').height(),\n    buttons_dh = $('.botbuttons').height(),\n    left_top_dh = $('#lefttop').outerHeight();\n    var items_dh = wh-120, list_table_dh = wh-185-left_top_dh-total_dh-buttons_dh;\n    $('#right-col').height(wh-100);\n    $('.items').height((items_dh > 400 ? items_dh : 400));\n    $('#list-table-div').height(list_table_dh);\n}\n\nfunction printLine(str) {\n    var size = parseInt(Settings.char_per_line)-4;\n    var len = str.length;\n    var res = str.split(\":\");\n    var newd = res[0];\n    for(i=1; i<(size-len); i++) {\n        newd += \" \";\n    }\n    newd += res[1];\n    return newd;\n}\n\n$(window).bind(\"resize\", posScreen);\n\nfunction read_card() {\n\n}\n\n$.extend($.keyboard.keyaction, {\n    enter : function(base) {\n        if (base.$el.is(\"textarea\")){\n            base.insertText('\\r\\n');\n        } else {\n            base.accept();\n        }\n    }\n});\n\n$(document).ready(function() {\n    posScreen();\n    if (Settings.display_kb == 1) { display_keyboards(); }\n    nav_pointer();\n    loadItems();\n    read_card();\n\n    $('.swipe').keypress( function (e) {\n        var TrackData = $(this).val() ? $(this).val() : '';\n        if(TrackData != '') {\n            if (e.keyCode == 13) {\n                e.preventDefault();\n                var p = new SwipeParserObj(TrackData);\n\n                if(p.hasTrack1)\n                {\n\n                    var CardType = null;\n                    var ccn1 = p.account.charAt(0);\n                    if(ccn1 == 4)\n                        CardType = 'Visa';\n                    else if(ccn1 == 5)\n                        CardType = 'MasterCard';\n                    else if(ccn1 == 3)\n                        CardType = 'Amex';\n                    else if(ccn1 == 6)\n                        CardType = 'Discover';\n                    else\n                        CardType = 'Visa';\n\n                    $('#pcc_no').val(p.account).change();\n                    $('#pcc_holder').val(p.account_name).change();\n                    $('#pcc_month').val(p.exp_month).change();\n                    $('#pcc_year').val(p.exp_year).change();\n                    $('#pcc_cvv2').val('');\n                    $('#pcc_type').select2('val', CardType);\n\n                } else {\n                    $('#pcc_no').val('').change();\n                    $('#pcc_holder').val('').change();\n                    $('#pcc_month').val('').change();\n                    $('#pcc_year').val('').change();\n                    $('#pcc_cvv2').val('').change();\n                    $('#pcc_type').val('').change();\n                }\n\n                $('#pcc_cvv2').focus();\n            }\n        }\n\n    }).blur(function (e) {\n        $(this).val('');\n    }).focus( function (e) {\n        $(this).val('');\n    });\n\n    $(document).on('blur', '#pcc_no', function () {\n        var cn = $(this).val();\n        var ccn1 = cn.charAt(0);\n        if(ccn1 == 4)\n            CardType = 'Visa';\n        else if(ccn1 == 5)\n            CardType = 'MasterCard';\n        else if(ccn1 == 3)\n            CardType = 'Amex';\n        else if(ccn1 == 6)\n            CardType = 'Discover';\n        else\n            CardType = 'Visa';\n\n        $('#pcc_type').select2('val', CardType);\n    });\n\n    $('.modal').on('hidden.bs.modal', function() {\n        $(this).removeData('bs.modal');\n    });\n    $('#clearLS').click(function(event) {\n        bootbox.confirm(lang.r_u_sure, function(result) {\n            if(result == true) {\n                localStorage.clear();\n                location.reload();\n            }\n        });\n        return false;\n    });\n\n    if(Settings.focus_add_item != '') {\n        shortcut.add(Settings.focus_add_item, function() { $(\"#add_item\").focus(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.add_customer != '') {\n        shortcut.add(Settings.add_customer, function() { $(\"#add-customer\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.toggle_category_slider != '') {\n        shortcut.add(Settings.toggle_category_slider, function() { $('[data-toggle=\"control-sidebar\"]').trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.cancel_sale != '') {\n        shortcut.add(Settings.cancel_sale, function() { $(\"#reset\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n    }\n    if(Settings.suspend_sale != '') {\n       shortcut.add(Settings.suspend_sale, function() { $(\"#suspend\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.print_order != '') {\n       shortcut.add(Settings.print_order, function() { $(\"#print_order\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.print_bill != '') {\n       shortcut.add(Settings.print_bill, function() { $(\"#print_bill\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.finalize_sale != '') {\n       shortcut.add(Settings.finalize_sale, function() { $(\"#payment\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.today_sale != '') {\n       shortcut.add(Settings.today_sale, function() { $(\"#today_sale\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.open_hold_bills != '') {\n       shortcut.add(Settings.open_hold_bills, function() { $(\"#opened_bills\").trigger('click'); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n   if(Settings.close_register != '') {\n       shortcut.add(Settings.close_register, function() { $(\"#close_register\").click(); }, { 'type':'keydown', 'propagate':false, 'target':document} );\n   }\n\n});\n$.fn.focusToEnd = function() { return this.each(function() { var v = $(this).val(); $(this).focus().val(\"\").val(v); }); };\n$.ajaxSetup ({ cache: false, headers: { \"cache-control\": \"no-cache\" } });\n"]}